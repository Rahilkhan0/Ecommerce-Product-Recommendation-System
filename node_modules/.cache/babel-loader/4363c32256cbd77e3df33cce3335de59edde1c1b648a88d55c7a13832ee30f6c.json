{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useSearchParams,useNavigate}from'react-router-dom';import axios from'axios';import'./Search.css';import Products from'./Products';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const Search=_ref=>{let{cart,setCart,handleAddToCart}=_ref;const[searchParams]=useSearchParams();const[recommendations,setRecommendations]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState('');const productName=searchParams.get('query');const navigate=useNavigate();const storeLastSearchedProduct=(productName,results)=>{if(productName&&(results===null||results===void 0?void 0:results.length)>0){const lastProduct={name:productName,timestamp:new Date().toISOString(),relatedProducts:results.slice(0,3).map(p=>p.Name)};localStorage.setItem('lastSearchedProduct',JSON.stringify(lastProduct));}};const getValidImageUrl=imageUrl=>{const urls=imageUrl===null||imageUrl===void 0?void 0:imageUrl.split('|').map(url=>url.trim()).filter(Boolean);return(urls===null||urls===void 0?void 0:urls[0])||'https://via.placeholder.com/150';};const handleCardClick=product=>{navigate(`/product-detail?query=${product.Name}`,{state:{product}});};useEffect(()=>{const fetchRecommendations=async()=>{if(!productName)return;setLoading(true);setError('');try{const response=await axios.get(`http://localhost:5000/content-recommendation`,{params:{item_name:productName}});setRecommendations(response.data);storeLastSearchedProduct(productName,response.data);}catch(err){console.error(err);setError('Failed to fetch recommendations. Please try again.');}finally{setLoading(false);}};fetchRecommendations();},[productName]);return/*#__PURE__*/_jsxs(\"div\",{className:\"search-container\",children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Search Results for \\\"\",productName,\"\\\"\"]}),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:error}),!loading&&!error&&recommendations.length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"no-results\",children:\"No recommendations found.\"}),/*#__PURE__*/_jsx(Products,{items:recommendations,handleAddToCart:handleAddToCart,handleClick:handleCardClick})]});};export default Search;","map":{"version":3,"names":["React","useState","useEffect","useSearchParams","useNavigate","axios","Products","jsxs","_jsxs","jsx","_jsx","Search","_ref","cart","setCart","handleAddToCart","searchParams","recommendations","setRecommendations","loading","setLoading","error","setError","productName","get","navigate","storeLastSearchedProduct","results","length","lastProduct","name","timestamp","Date","toISOString","relatedProducts","slice","map","p","Name","localStorage","setItem","JSON","stringify","getValidImageUrl","imageUrl","urls","split","url","trim","filter","Boolean","handleCardClick","product","state","fetchRecommendations","response","params","item_name","data","err","console","className","children","items","handleClick"],"sources":["C:/Users/Arbaz Khan/recommendation-system/frontend/src/components/Search.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useSearchParams, useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport './Search.css';\r\nimport Products from './Products';\r\n\r\nconst Search = ({ cart, setCart, handleAddToCart }) => {\r\n  const [searchParams] = useSearchParams();\r\n  const [recommendations, setRecommendations] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  \r\n  const productName = searchParams.get('query');\r\n  const navigate = useNavigate();\r\n\r\n   \r\n  const storeLastSearchedProduct = (productName, results) => {\r\n    if (productName && results?.length > 0) {\r\n      const lastProduct = {\r\n        name: productName,\r\n        timestamp: new Date().toISOString(),\r\n        relatedProducts: results.slice(0, 3).map(p => p.Name)\r\n      };\r\n      localStorage.setItem('lastSearchedProduct', JSON.stringify(lastProduct));\r\n    }\r\n  };\r\n\r\n  const getValidImageUrl = (imageUrl) => {\r\n    const urls = imageUrl?.split('|').map(url => url.trim()).filter(Boolean);\r\n    return urls?.[0] || 'https://via.placeholder.com/150';\r\n  };\r\n\r\n  const handleCardClick = (product) => {\r\n    navigate(`/product-detail?query=${product.Name}`, { state: { product } });\r\n  };\r\n\r\n  useEffect(() => {\r\n    const fetchRecommendations = async () => {\r\n      if (!productName) return;\r\n      setLoading(true);\r\n      setError('');\r\n      try {\r\n        const response = await axios.get(`http://localhost:5000/content-recommendation`, {\r\n          params: { item_name: productName }\r\n        });\r\n        setRecommendations(response.data);\r\n        storeLastSearchedProduct(productName, response.data);\r\n      } catch (err) {\r\n        console.error(err);\r\n        setError('Failed to fetch recommendations. Please try again.');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchRecommendations();\r\n  }, [productName]);\r\n\r\n  return (\r\n    <div className=\"search-container\">\r\n      <h1>Search Results for \"{productName}\"</h1>\r\n\r\n      {loading && <div className=\"loading-spinner\"></div>}\r\n      {error && <p className=\"error-message\">{error}</p>}\r\n      {!loading && !error && recommendations.length === 0 && (\r\n        <p className=\"no-results\">No recommendations found.</p>\r\n      )}\r\n\r\n      <Products\r\n        items={recommendations}\r\n        handleAddToCart={handleAddToCart}\r\n        handleClick={handleCardClick}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Search;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}